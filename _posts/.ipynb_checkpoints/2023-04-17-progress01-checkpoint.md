---
layout: post
title: "threading和multiprocessing的区别"
date: 2023-04-17
description: "多线程或多进程"
tags: 并行运行
--- 
## threading和multiprocessing的区别


threading、multiprocessing和concurrent都是Python中用于实现并发编程的标准库。

主要区别在于：

1、threading实现的是多线程编程，多个线程共享同一个进程的内存空间，因此线程间的通信和数据共享比较容易。但是由于全局解释器锁（GIL）的存在，所以多线程并不能完全发挥多核CPU的优势。

2、multiprocessing实现的是多进程编程，每个进程都有自己独立的内存空间，因此进程间的通信和数据共享需要通过特定的方式来实现。但是由于每个进程都有独立的解释器和全局解释器锁，所以可以完全发挥多核CPU的优势。

3、concurrent库是Python3.2版本中新增加的，主要用于编写异步代码，可以支持协程和线程池。在Python3.4版本之后，asyncio库也被加入到标准库中，提供了更加强大的异步编程能力。

总的来说，threading适用于I/O密集型任务，multiprocessing适用于CPU密集型任务，而concurrent和asyncio则是用于实现异步编程的库。


## 多线程和多进程的区别
多线程和多进程都是用于实现并行计算的技术，但它们之间有一些重要的区别。

1、线程和进程的概念不同：进程是操作系统分配资源的基本单位，它拥有独立的地址空间、内存、文件描述符等资源，一个进程可以包含多个线程。线程是进程内部的一个执行单元，它与进程共享地址空间、内存、文件描述符等资源。

2、线程的创建、销毁和切换比进程快：由于线程是在进程内部创建的，因此创建、销毁和切换线程的开销比创建、销毁和切换进程的开销要小得多。

3、进程的资源隔离和安全性更好：每个进程都拥有独立的地址空间和内存，因此进程间的资源隔离和安全性更好。而线程共享进程的资源，因此一个线程的错误可能会影响整个进程。

4、多线程适合I/O密集型任务，多进程适合CPU密集型任务：由于线程共享进程的资源，因此在I/O密集型任务中，多线程可以更好地利用CPU。而多进程则适合于CPU密集型任务，因为它们可以在多个CPU上并行执行。

5、进程间通信的方式不同：多进程需要使用IPC（Inter-Process Communication）机制来实现进程间通信，如管道、消息队列、共享内存等。而多线程可以通过共享内存、信号量、条件变量等方式来实现线程间通信。

总的来说，多线程适合I/O密集型任务，因为它们可以更好地利用CPU资源，而多进程则适合CPU密集型任务，因为它们可以在多个CPU上并行执行，从而提高计算速度。但是，由于多线程存在一些线程安全的问题，因此在实现并发计算时需要考虑线程安全问题，如共享资源的同步和互斥。


## 异步编程
异步编程是一种编程模型，可以让代码在等待某个操作完成的同时，继续执行其它任务，而不是像传统的同步编程模型那样，必须等待操作完成后才能执行下一步。

在异步编程中，当一个任务需要等待另一个任务完成时，会将等待操作交给事件循环（event loop）处理，然后继续执行下一步任务。事件循环会负责调度所有任务，将它们按照特定的算法合理地分配在不同的线程或进程上，从而提高代码的运行效率和并发性能。

异步编程通常使用协程（coroutine）或异步函数（async function）来实现。在Python中，使用asyncio模块提供的事件循环和协程机制，可以很方便地进行异步编程。